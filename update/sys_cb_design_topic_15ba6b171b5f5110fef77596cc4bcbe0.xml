<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="Submit a Request">59ba6f931b5f5110fef77596cc4bcbd3</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"430c97f993de430e92c615b4de6ad381","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"430c97f993de430e92c615b4de6ad381"}],"goals":[{"name":"primary","trigger_id":"430c97f993de430e92c615b4de6ad381","nodes":[{"type":"StartGoal","goal_id":"primary","greeting_msg":{"type":"String","mode":"string","value":""},"id":"f54e34b5775c41059e51f663dbf00e83","name":"Start"},{"type":"TerminateGoal","goal_id":"primary","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"df67f2f247204aa68ac52939e4e94c09","name":"End"},{"type":"LibraryCall","library_topic_name":"Search Catalog Item","library_topic_id":"ccaacd71c3a3330012d1758a7ff57ecd","parameter-mappings":[{"parameter-name":"catalogs","value":{"type":"String","mode":"string","value":"{{vaVars.catalogs_tobe_searched}}"},"metadata":{"type":"String","list":false,"items":[],"use_items":false}},{"parameter-name":"query_term","value":{"type":"String","mode":"string","value":"{{vaInputs.search_term}}"},"metadata":{"type":"String","list":false,"items":[],"use_items":false}}],"return-value-mappings":[{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"catalog_item_id","main_topic_mapped_variable_name":"catalog_item_id"},{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"item_type","main_topic_mapped_variable_name":"item_type"},{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"is_conversational","main_topic_mapped_variable_name":"is_conversational"}],"id":"1e75dce1468a49e984d188758efe0edb","name":"Search Catalog Item","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"d5dd06d0b2fe4057a0c8624f99654b71","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"What are you looking for?\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":true,"use_confirmation_prompt":false},"skippable":{"type":"Applicability","mode":"script","value":"false"},"id":"3edb429d85e348e795f6e36d665346a0","name":"Search Term","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"formatType":"Text","validationScript":""},{"type":"LinkOutputPrompt","header":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Please click on the link below to complete the request:\", vaContext.getRequesterLang())"},"label":{"type":"String","mode":"script","value":"(function execute() {\n    return JSON.parse(vaVars.selected_item).title;\n})()\n"},"url":{"type":"String","mode":"script","value":"(function execute() {\n    return vaVars.baseUri+JSON.parse(vaVars.selected_item).selected_link;\n})()\n"},"link_type":"single","multi_link_script":"","id":"5e0765814c8e4ac399e2b030fb3fef13","name":"Display link","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n        var catItemObj = new sn_sc.CatItem(vaInputs.catalog_item_id);\n        var catItemJson = catItemObj.read({\n            \"name\" : \"\"\n        }, true);\n        var itemJSON = {'sys_id': vaInputs.catalog_item_id, 'title': catItemJson.name, 'selected_link':''};\n        if(vaVars.portal == null)\n            itemJSON.selected_link = vaVars.default_portal;\n        else\n            itemJSON.selected_link = vaVars.portal;\n        itemJSON.selected_link = itemJSON.selected_link + '?id=sc_cat_item&amp;sys_id=' + vaInputs.catalog_item_id;\n        vaVars.selected_item = JSON.stringify(itemJSON);\n})()\n","id":"33cd6b49f3f64b68a646267bd6308d3b","name":"Fetch Catalog Info","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"604e341a1e044500a0b215224508bae3","message":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getMessage('Do you want to proceed with \\'{0}\\'?', [JSON.parse(vaVars.selected_item).title]);\n})()\n"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":false,"use_confirmation_prompt":true},"skippable":{"type":"Applicability","mode":"script","value":"false"},"id":"137c56198ad8482bb17eded8914bc001","name":"Proceed","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Yes","expression":{"type":"Applicability","mode":"query","value":"proceed=true"},"id":"a3309f70e4c646dfa7798f168de18d63","name":"Yes"},{"type":"Branch","label":"No","expression":{"type":"Applicability","mode":"query","value":"proceed="},"id":"9f13c862afab469e8746063d6622abf6","name":"No"}],"id":"db04007b522440c388c90da323ffff50","goal_id":"primary"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Okay, let's try again\", vaContext.getRequesterLang())"},"id":"45d478cabe624b59b29e961b1105db9d","name":"Try again","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"secure":false},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Catalog item selected","expression":{"type":"Applicability","mode":"query","value":"catalog_item_idISNOTEMPTY"},"id":"28bfdb1e497f4b70ae2e26f180968486","name":"Catalog item selected"},{"type":"Branch","label":"No Catalog selected","expression":{"type":"Applicability","mode":"query","value":"catalog_item_idISEMPTY"},"id":"8d43dc08836e415cbf04029f8850f6f0","name":"No Catalog selected"}],"id":"a8ccdf38bbae456789dcee3eb8f21f49","goal_id":"primary"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Sorry, but I couldn't find any relevant items.\", vaContext.getRequesterLang())"},"id":"470316888fdc4a00b1ca5973fcecfdca","name":"No Catalog items ack","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"secure":false},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"true","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (!gs.nil(vaVars.catalogs_tobe_searched) &amp;&amp; !gs.nil(vaVars.portal)) || gs.nil(vaVars.portal);\n})()\n"},"id":"b67263fdc24b4737a73092da305f7697","name":"true"},{"type":"Branch","label":"false","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (gs.nil(vaVars.catalogs_tobe_searched) &amp;&amp; !gs.nil(vaVars.portal));\n})()\n"},"id":"fa959fdc3d524dd9ab730f5eda78600c","name":"false"}],"id":"31b5d93672d0443cb670b13e117c2d6f","goal_id":"primary"},{"type":"ScriptedAction","script":"(function execute() {\n    var catalogArray = [];\n    if(!gs.nil(vaVars.portal)) {\n        var portal_catalog = new GlideRecord('m2m_sp_portal_catalog');\n        portal_catalog.addQuery('sp_portal.url_suffix', vaVars.portal);\n        portal_catalog.addActiveQuery();\n        portal_catalog.query();\n        \n        while (portal_catalog.next()) {\n            catalogArray.push(portal_catalog.getValue('sc_catalog'));\n        }\n    }\n    vaVars.catalogs_tobe_searched = catalogArray.join();\n})()\n","id":"2a40017fd54a4d5892847be12513cb05","name":"Portal Catalogs","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}}],"edges":[{"type":"Edge","source_node_id":"f54e34b5775c41059e51f663dbf00e83","target_node_id":"3edb429d85e348e795f6e36d665346a0","id":"0f1f8e69581b4a72bea1e8b716f21483"},{"type":"Edge","source_node_id":"33cd6b49f3f64b68a646267bd6308d3b","target_node_id":"137c56198ad8482bb17eded8914bc001","id":"016a195bf1c742ff87ecffed4789e597"},{"type":"Edge","source_node_id":"5e0765814c8e4ac399e2b030fb3fef13","target_node_id":"df67f2f247204aa68ac52939e4e94c09","id":"7efa330dd927472b85496a3a2360bcf5"},{"type":"Edge","source_node_id":"137c56198ad8482bb17eded8914bc001","target_node_id":"db04007b522440c388c90da323ffff50","id":"70b95d92f8cd49dcae9109a626c2a6de"},{"type":"Edge","source_node_id":"db04007b522440c388c90da323ffff50","target_node_id":"5e0765814c8e4ac399e2b030fb3fef13","branch_id":"a3309f70e4c646dfa7798f168de18d63","id":"6ac74b1c2e4e40f8809307a7fb9214f1","name":"a3309f70e4c646dfa7798f168de18d63"},{"type":"Edge","source_node_id":"db04007b522440c388c90da323ffff50","target_node_id":"45d478cabe624b59b29e961b1105db9d","branch_id":"9f13c862afab469e8746063d6622abf6","id":"841436fc5d704a96a15d695c63c93e51","name":"9f13c862afab469e8746063d6622abf6"},{"type":"Edge","source_node_id":"45d478cabe624b59b29e961b1105db9d","target_node_id":"3edb429d85e348e795f6e36d665346a0","id":"e66b1f3feb7845d7a49766e926ee352a"},{"type":"Edge","source_node_id":"1e75dce1468a49e984d188758efe0edb","target_node_id":"a8ccdf38bbae456789dcee3eb8f21f49","id":"864cf372e35348ba9478df52c140176f"},{"type":"Edge","source_node_id":"470316888fdc4a00b1ca5973fcecfdca","target_node_id":"df67f2f247204aa68ac52939e4e94c09","id":"52792649397e4f9c9b75d686a454e002"},{"type":"Edge","source_node_id":"a8ccdf38bbae456789dcee3eb8f21f49","target_node_id":"33cd6b49f3f64b68a646267bd6308d3b","branch_id":"28bfdb1e497f4b70ae2e26f180968486","id":"3c4118dbc57743b39ff862c0f6c7d1cf","name":"28bfdb1e497f4b70ae2e26f180968486"},{"type":"Edge","source_node_id":"a8ccdf38bbae456789dcee3eb8f21f49","target_node_id":"470316888fdc4a00b1ca5973fcecfdca","branch_id":"8d43dc08836e415cbf04029f8850f6f0","id":"a59bdd9728ff40408d7f2c308c6e3700","name":"8d43dc08836e415cbf04029f8850f6f0"},{"type":"Edge","source_node_id":"31b5d93672d0443cb670b13e117c2d6f","target_node_id":"1e75dce1468a49e984d188758efe0edb","branch_id":"b67263fdc24b4737a73092da305f7697","id":"92e6fcab58bc4f7dafbe05249c11b09c","name":"b67263fdc24b4737a73092da305f7697"},{"type":"Edge","source_node_id":"31b5d93672d0443cb670b13e117c2d6f","target_node_id":"470316888fdc4a00b1ca5973fcecfdca","branch_id":"fa959fdc3d524dd9ab730f5eda78600c","id":"7c916f43b02d4705ac707ac46539b32a","name":"fa959fdc3d524dd9ab730f5eda78600c"},{"type":"Edge","source_node_id":"3edb429d85e348e795f6e36d665346a0","target_node_id":"2a40017fd54a4d5892847be12513cb05","id":"12e9d5525789488cadd2790a1523dc35"},{"type":"Edge","source_node_id":"2a40017fd54a4d5892847be12513cb05","target_node_id":"31b5d93672d0443cb670b13e117c2d6f","id":"254c985c069b45779c71046a74f5a67a"}],"id":"primary"}],"script_variables":[{"type":"String","name":"selected_item","value":{"type":"String","mode":"string"},"list":false,"id":"ffbe9d7c24a342e69b621eead592170a","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"portal","value":{"type":"String","mode":"script","value":"(function execute() {\n    return vaContext.portal == undefined ? null : vaContext.portal;\n})()"},"list":false,"id":"eaad7a71e3f241778861692577579ef5","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"default_portal","value":{"type":"String","mode":"string","value":"csm"},"list":false,"id":"a5bf50cbbe554f4eba4b5b72d7be8755","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"baseUri","value":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getProperty('glide.servlet.uri');\n})()\n"},"list":false,"id":"f97f30f0e16542aba4e7eda7e94c828e","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"catalogs_tobe_searched","value":{"type":"String","mode":"string"},"list":false,"id":"c08b7c25640a4c3da8631b701b623d87","formatType":"text","secure":false,"sensitive":false}],"glide_variables":[{"type":"String","name":"search_term","list":false,"id":"d5dd06d0b2fe4057a0c8624f99654b71","formatType":"Text","validationScript":"","secure":false,"sensitive":false},{"type":"True/False","id":"604e341a1e044500a0b215224508bae3","name":"proceed","formatType":"text","secure":false,"sensitive":false,"list":false},{"type":"String","name":"catalog_item_id","list":false,"id":"b46246d364284311a20b64ca012c33de","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"String","name":"item_type","list":false,"id":"68a37b61a4c64788b40160fdcc2f1fcc","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"String","name":"is_conversational","list":false,"id":"9d85f493236240d6b557ebe7c141eaee","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"Reference","table":"sys_user","id":"1ad2eb422db9422e9ba4ef141467720e","name":"user","formatType":"text","secure":false,"sensitive":false,"list":false}],"applicability":{"type":"Applicability","mode":"script","value":"true"},"roles":["admin","virtual_agent_admin","sn_customerservice.customer","sn_customerservice.consumer"],"scope":"6ead8e780f603200cd674f8ce1050ed1","domain":"global","topic_type":"STANDARD","channels":[],"id":"ff58a7531b5f5110fef77596cc4bcb33","name":"Submit a Request","key_phrases":["Submit a Request","Submit Request"],"nlu_provider":"","nlu_model":"","nlu_model_label":"","nlu_intent":"","nlu_intent_label":"","flexible_conversation_switching":false,"autopilot_topic":false,"design_categories":[{"name":null,"visible":false,"sysId":"b28634c4b7b93300da7ab948ee11a93a"}],"triggerable_by_notification":false,"library":false,"readOnly":false,"nluMapping":"[]"}</design_definition>
        <design_topic_id>ff58a7531b5f5110fef77596cc4bcb33</design_topic_id>
        <name>Submit a Request</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-11-27 00:43:59</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>15ba6b171b5f5110fef77596cc4bcbe0</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_cb_design_topic_15ba6b171b5f5110fef77596cc4bcbe0</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2022-11-27 00:44:06</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
